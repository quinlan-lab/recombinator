<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://github.com/quinlan-lab/recombinator/">
        <link rel="shortcut icon" href="./img/favicon.ico">

	<title>recombinator</title>

        <link href="./css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="./css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="./css/highlight.css">
        <link href="./css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href=".">recombinator</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="active">
                    <a href=".">Home</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li class="disabled">
                    <a rel="next" >
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li class="disabled">
                    <a rel="prev" >
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/quinlan-lab/recombinator/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#recombinator">recombinator</a></li>
        
            <li><a href="#example-plot">Example Plot</a></li>
        
    
        <li class="main "><a href="#cohort-plots-and-stats">Cohort Plots and Stats</a></li>
        
    
        <li class="main "><a href="#enrichment">Enrichment</a></li>
        
    
        <li class="main "><a href="#phased-vs-unphased">Phased vs Unphased</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="recombinator">recombinator</h1>
<p><em>recombinator</em> calls crossovers, de novo mutations, given phased or unphased VCFs.</p>
<p>It will extract information, make plots, and report info about variants.</p>
<pre><code>python -m recombinator \
    recombinator \
    --ped $ped \
    --vcf $vcf \
    --region $chrom \
    --prefix xos
</code></pre>

<p>This will output a directory structure with informative sites per-family and then an aggregate file
with all families that looks like:</p>
<pre><code>chrom   start   end family_id   parent_id   left-block  left-informative-sites  right-block right-informative-sites change
6   13362448    13371471    xx109   GOG012978   6:205799-13362449   5317    6:13371471-42449797 12572   0-1
6   42449796    42454760    xx109   GOG012978   6:13371471-42449797 12572   6:42454760-52769531 3372    1-0
6   52769530    52799232    xx109   GOG012978   6:42454760-52769531 3372    6:52799232-72183699 7443    0-1
6   72183698    72210615    xx109   GOG012978   6:52799232-72183699 7443    6:72210615-111961096    12339   1-0
6   111961095   111971518   xx109   GOG012978   6:72210615-111961096    12339   6:111971518-133578815   5639    0-1
6   133578814   133617587   xx109   GOG012978   6:111971518-133578815   5639    6:133617587-154285086   6058    1-0
6   154285085   154318283   xx109   GOG012978   6:133617587-154285086   6058    6:154318283-170919515   4753    0-1
6   110849230   110909829   xx109   GOG10572    6:7934314-110849231 36477   6:110909829-167867452   18916   1-0
6   167867451   167871017   xx109   GOG10572    6:110909829-167867452   18916   6:167871017-170919470   1267    0-1
6   11221929    11249151    x3750   GOG08928    6:217200-11221930   4411    6:11249151-14621353 1188    1-0
6   14621352    14626728    x3750   GOG08928    6:11249151-14621353 1188    6:14626728-138337903    54524   0-1
6   138337902   138352068   x3750   GOG08928    6:14626728-138337903    54524   6:138352068-170921794   16314   1-0
</code></pre>

<p>That's for unphased data. For phased data, it will also list the kid in
which the crossover is detected (not possible in unphased).</p>
<p>There will be files:
+ $prefix/$region.crossovers-unfiltered.bed
  - contains the only mimimally filtered crossovers that seem valid for all samples
+ $prefix/$region.crossovers.bed
  - contains a more filtered set (but may exclude small gene conversions) for all samples
+ $prefix/$region/$region.$family.png shows a plot of the crossovers like the example below.
+ $prefix/$region/$region.$family.$parent.bed.gz contains all of the informative sites
  in that parent. Any time the 'same' column changes, there is a putative crossover.</p>
<h2 id="example-plot">Example Plot</h2>
<p>First we show where there is a true crossover. The black points indicate informative variants.
The values of the black points indicate the crossover state where
the value is 1 if the alternate allele is at the same index (1st or 2nd) in both the parent
and the kid. The value is 0 if they are different. We can see that the genotype calls are extremely
good here, in many cases, we'd expect to see more single points outside of the blue blocks which
indicate the inferred state for a region. The red line indicates the location of a crossover.</p>
<p><img alt="xo" src="https://cloud.githubusercontent.com/assets/1739/18555974/1697ac52-7b27-11e6-8faf-9659b2fd9c15.png" title="Clean Crossover" /></p>
<p>Below, we show a case where there is no crossover for the entire chromosome. We do see a few noisy
points that are likely due to genotyping error.</p>
<p><img alt="noxo" src="https://cloud.githubusercontent.com/assets/1739/18555978/19f7dd54-7b27-11e6-8da8-eb749b8093ce.png" title="No Crossovers" /></p>
<h1 id="cohort-plots-and-stats">Cohort Plots and Stats</h1>
<p>Once the recombinator script has run. The <code>cohort-plots</code> command
can be run as:</p>
<pre><code>python -m recombinator cohort-plots --ped $ped --prefix $prefix crossovers.bed
</code></pre>

<p>and it will output a plot of crossover hot-spots separated by chromosome
and separating maternal from paternal. E.g.</p>
<p><img alt="hotspots" src="https://cloud.githubusercontent.com/assets/1739/18610633/3b81d9a8-7cde-11e6-813c-9ff3286fce4d.png" title="hotspots" /></p>
<p>Where we see a nice hotspot from fathers at about 65MB on chromosome 13.
The dashed lines indicate a z-score cutoff of &gt;= 2.58, meaning values above (or below for males) that line
are above the 99.5% confidence of the data. We do not assume the data is normally distributed, but this makes
a reasonable cutoff for plotting.</p>
<p>A bed file is sent to stdout with:
+ the number of crossovers at each site
+ the parental sex of 'male', 'female', or 'both' where 'both is the sum of male and female crossovers.
+ the zscore of the number of crossovers.
It is expected that users will filter this to their own z-score cutoff and sex as needed.</p>
<p>It will also create an aggregate plot with the count of maternal and paternal crossovers:
<img alt="sex" src="https://cloud.githubusercontent.com/assets/1739/18605165/cb82df12-7c47-11e6-80da-0985482de14c.png" title="sex" /></p>
<h1 id="enrichment">Enrichment</h1>
<p>After finding per-sample recombination sites, we will want to know if certain events are enriched in those crossovers. For example, we may expect that de novos are more likely to occur in a crossover
from the same sample.
We can evaluate this by comparing the observed number of overlaps between crossovers and de novos
in the same sample Vs the expected, which we derive by shuffling the sample-ids of the crossovers.
By shuffling the sample ids, we avoid bias due to genome composition at crossovers that would
come into play if we shuffled the spatial location of the events.</p>
<p>This can be done like this:</p>
<pre><code>python -m recombinator enrichment $crossovers.all-samples.bed denovos.all-samples.bed --simulations 1000
</code></pre>

<p>To compare the sample-overlap in 1000 simulations to the single observed event.
This assumes that <code>crossovers.all-samples.bed</code> and <code>denovos.all-samples.bed</code> have a <code>sample_id</code>
column that indicates the sample in which the event occurred.</p>
<p>An example output looks like:</p>
<p><img alt="dnxo" src="https://cloud.githubusercontent.com/assets/1739/18727794/a4b475b2-8007-11e6-9b77-85a4918359d1.png" title="DN::XO" /></p>
<p>Where we see that, the observed de-novo::xo overlaps shown as the green line (57) is higher than
nearly all of the simulated values in blue.</p>
<p>While this example is for de novos, it can be used to compare crossovers to any data containg regions labelled by sample.</p>
<h1 id="phased-vs-unphased">Phased vs Unphased</h1>
<p>In our experience, it's not simple to phase large cohorts with available methods. Beagle is quadratic in the
number of samples and shapeit does not give good results even with strict quality-filtering on input variants.</p>
<p>To get around this, the pipeline we recommend is to run <code>recombinator</code> on the unphased VCF. Then, run
<code>phased-from-unphased.sh</code> which will gather any pairs of variants between which there is a state-change.
It will combine those crossover-bounding variants with the (~2.5 million) omni-2.5 sites, output a with
only those sites, phase it, and run recombinator on the phased.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="./js/jquery-1.10.2.min.js"></script>
        <script src="./js/bootstrap-3.0.3.min.js"></script>
        <script src="./js/highlight.pack.js"></script>
        <script>var base_url = '.';</script>
        <script data-main="./mkdocs/js/search.js" src="./mkdocs/js/require.js"></script>
        <script src="./js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>